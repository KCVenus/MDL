{% extends 'base.html.twig' %}

{% block hero %}
<!-- Modals pour les différents messages -->
{% for modal in [
    {'id': 'AtelierSuccess', 'title': 'Succès', 'body': 'Données enregistrées avec succès'},
    {'id': 'AtelierNone', 'title': 'Erreur', 'body': 'Aucun atelier présent en BDD'},
    {'id': 'AtelierDate', 'title': 'Erreur', 'body': 'Les dates ne correspondent pas'},
    {'id': 'AtelierError', 'title': 'Erreur', 'body': 'Les champs doivent être remplis'}
] %}
    <div class="modal fade" id="{{ modal.id }}" tabindex="-1" aria-labelledby="modalLabel{{ modal.id }}" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-white border-0 shadow-lg">
                <div class="modal-header bg-gray-100 border-b border-gray-200">
                    <h5 class="modal-title text-lg leading-6 font-medium text-gray-900" id="modalLabel{{ modal.id }}">{{ modal.title }}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body text-sm text-gray-500">{{ modal.body }}</div>
                <div class="modal-footer bg-gray-50 border-t border-gray-200">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>
{% endfor %}

<!-- Formulaire -->
{{ form_start(form, {'attr': {'class': 'space-y-6'}}) }}
    <div class="form-group">
        {{ form_label(form.type) }}
        {{ form_widget(form.type, {'attr': {'class': 'form-control'}}) }}
    </div>

    <!-- Champs conditionnels -->
    <div id="atelier-fields" style="display:none;" class="p-4 border rounded-lg bg-gray-50">
        {{ form_row(form.atelier.libelle, {'attr': {'class': 'form-control'}}) }}
        {{ form_row(form.atelier.nbPlacesMaxi, {'attr': {'class': 'form-control'}}) }}
    </div>

    <div id="theme-fields" style="display:none;" class="p-4 border rounded-lg bg-gray-50">
        {{ form_row(form.theme.atelier, {'attr': {'class': 'form-control'}}) }}
        {{ form_row(form.theme.libelle, {'attr': {'class': 'form-control'}}) }}
    </div>

    <div id="vacation-fields" style="display:none;" class="p-4 border rounded-lg bg-gray-50">
        {{ form_row(form.vacation.atelier, {'attr': {'class': 'form-control'}}) }}
        {{ form_row(form.vacation.dateDebut, {'attr': {'class': 'form-control'}}) }}
        {{ form_row(form.vacation.dateFin, {'attr': {'class': 'form-control'}}) }}
    </div>

    <div class="form-group">
        {{ form_widget(form.save, {'attr': {'class': 'btn btn-primary'}}) }}
    </div>
{{ form_end(form) }}

<script>
    document.addEventListener('DOMContentLoaded', function() {
        function updateFields() {
            var selectedType = document.querySelector('input[name="form[type]"]:checked').value;
            document.getElementById('atelier-fields').style.display = (selectedType === 'atelier') ? 'block' : 'none';
            document.getElementById('theme-fields').style.display = (selectedType === 'theme') ? 'block' : 'none';
            document.getElementById('vacation-fields').style.display = (selectedType === 'vacation') ? 'block' : 'none';
        }
        Array.from(document.querySelectorAll('input[name="form[type]"]')).forEach(function(radio) {
            radio.addEventListener('change', updateFields);
        });
        updateFields();
    });
</script>
{% endblock %}
